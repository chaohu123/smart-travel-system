<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smarttravel.route.mapper.TravelRoutePoiMapper">

    <resultMap id="TravelRoutePoiResult" type="com.smarttravel.route.domain.TravelRoutePoi">
        <id column="id" property="id"/>
        <result column="route_day_id" property="routeDayId"/>
        <result column="poi_type" property="poiType"/>
        <result column="poi_id" property="poiId"/>
        <result column="sort" property="sort"/>
        <result column="stay_time" property="stayTime"/>
        <result column="note" property="note"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="del_flag" property="delFlag"/>
    </resultMap>

    <insert id="insert" parameterType="com.smarttravel.route.domain.TravelRoutePoi" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO travel_route_poi
        (route_day_id, poi_type, poi_id, sort, stay_time, note, create_time, update_time, del_flag)
        VALUES
        (#{routeDayId}, #{poiType}, #{poiId}, #{sort}, #{stayTime}, #{note}, NOW(), NOW(), 0)
    </insert>

    <select id="selectByRouteDayId" parameterType="long" resultMap="TravelRoutePoiResult">
        SELECT id, route_day_id, poi_type, poi_id, sort, stay_time, note, create_time, update_time, del_flag
        FROM travel_route_poi
        WHERE route_day_id = #{routeDayId} AND del_flag = 0
        ORDER BY sort ASC
    </select>

    <update id="deleteByRouteDayId" parameterType="long">
        UPDATE travel_route_poi
        SET del_flag = 1, update_time = NOW()
        WHERE route_day_id = #{routeDayId}
    </update>

</mapper>















