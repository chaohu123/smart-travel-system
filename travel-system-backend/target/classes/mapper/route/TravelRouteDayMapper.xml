<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smarttravel.route.mapper.TravelRouteDayMapper">

    <resultMap id="TravelRouteDayResult" type="com.smarttravel.route.domain.TravelRouteDay">
        <id column="id" property="id"/>
        <result column="route_id" property="routeId"/>
        <result column="day_no" property="dayNo"/>
        <result column="title" property="title"/>
        <result column="intro" property="intro"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="del_flag" property="delFlag"/>
    </resultMap>

    <insert id="insert" parameterType="com.smarttravel.route.domain.TravelRouteDay" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO travel_route_day
        (route_id, day_no, title, intro, create_time, update_time, del_flag)
        VALUES
        (#{routeId}, #{dayNo}, #{title}, #{intro}, NOW(), NOW(), 0)
    </insert>

    <select id="selectByRouteId" parameterType="long" resultMap="TravelRouteDayResult">
        SELECT id, route_id, day_no, title, intro, create_time, update_time, del_flag
        FROM travel_route_day
        WHERE route_id = #{routeId} AND del_flag = 0
        ORDER BY day_no ASC
    </select>

    <update id="deleteByRouteId" parameterType="long">
        UPDATE travel_route_day
        SET del_flag = 1, update_time = NOW()
        WHERE route_id = #{routeId}
    </update>

    <update id="update" parameterType="com.smarttravel.route.domain.TravelRouteDay">
        UPDATE travel_route_day
        <set>
            <if test="dayNo != null">day_no = #{dayNo},</if>
            <if test="title != null">title = #{title},</if>
            <if test="intro != null">intro = #{intro},</if>
            update_time = NOW()
        </set>
        WHERE id = #{id} AND del_flag = 0
    </update>

    <update id="deleteById" parameterType="long">
        UPDATE travel_route_day
        SET del_flag = 1, update_time = NOW()
        WHERE id = #{id}
    </update>

</mapper>

























