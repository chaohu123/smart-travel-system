<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smarttravel.content.mapper.ContentTagMapper">
  <resultMap id="BaseResultMap" type="com.smarttravel.content.domain.ContentTag">
    <id column="id" property="id"/>
    <result column="content_type" property="contentType"/>
    <result column="content_id" property="contentId"/>
    <result column="tag_id" property="tagId"/>
    <result column="create_time" property="createTime"/>
    <result column="update_time" property="updateTime"/>
    <result column="del_flag" property="delFlag"/>
  </resultMap>

  <sql id="Base_Column_List">
    id, content_type, content_id, tag_id, create_time, update_time, del_flag
  </sql>

  <insert id="insert" parameterType="com.smarttravel.content.domain.ContentTag">
    INSERT INTO content_tag (content_type, content_id, tag_id, create_time, del_flag)
    VALUES (#{contentType}, #{contentId}, #{tagId}, NOW(), 0)
  </insert>

  <delete id="deleteByContent">
    DELETE FROM content_tag WHERE content_type = #{contentType} AND content_id = #{contentId}
  </delete>

  <select id="selectByContent" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM content_tag
    WHERE content_type = #{contentType}
      AND content_id = #{contentId}
      AND del_flag = 0
  </select>

  <select id="selectByContentIds" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM content_tag
    WHERE content_type = #{contentType}
      AND del_flag = 0
      <if test="contentIds != null and contentIds.size() > 0">
        AND content_id IN
        <foreach collection="contentIds" item="cid" open="(" separator="," close=")">
          #{cid}
        </foreach>
      </if>
  </select>
</mapper>



