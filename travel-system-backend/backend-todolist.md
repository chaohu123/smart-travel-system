# 后端 TodoList（Java + Spring Boot）

## 1. 工程与基础设施

- [ ] **后端工程初始化**
  - [ ] 基于  Spring Boot 模块化工程
  - [ ] 规划模块：`user`、`content`（游记/景点/美食）、`route`（线路）、`recommend`、`stat`（统计）、`ai`（AI 接口）等
  - [ ] 配置多环境配置文件（dev/test/prod）

- [ ] **数据库与 MyBatis 映射**
  - [ ] 设计并创建核心表结构（用户、游记、图片、景点、美食、线路、打卡、行为记录等）
  - [ ] 编写实体类与 Mapper 接口
  - [ ] 编写基础 CRUD SQL / XML / 注解

- [ ] **Redis 与缓存策略**
  - [ ] 集成 Redis 客户端
  - [ ] 缓存首页推荐数据、热门游记、热门景点
  - [ ] 设计缓存 key 规范与过期策略

- [ ] **统一异常处理与返回格式**
  - [ ] 定义统一响应结构（code / msg / data）
  - [ ] 全局异常处理（业务异常、参数校验、系统异常）

---

## 2. 用户与认证模块

- [ ] **微信登录对接**
  - [ ] 调用微信登录接口用 `code` 换取 `openid`
  - [ ] 新用户自动注册：写入用户表
  - [ ] 生成自定义 token（JWT 或 session）并返回前端
  - [ ] 维护用户登录状态（token 校验、过期时间）

- [ ] **用户信息维护**
  - [ ] 获取个人信息接口（基础信息 + 兴趣标签 +统计）
  - [ ] 更新个人资料接口（签名、常驻城市、性别等）
  - [ ] 兴趣标签管理接口（设置、查询）

- [ ] **权限控制**
  - [ ] 区分普通用户与管理员角色（与 Ruoyi 权限体系打通）
  - [ ] 接口权限注解与拦截器配置

---

## 3. 内容与资源管理模块（游记、景点、美食）

- [ ] **游记管理（用户侧接口）**
  - [ ] 查询游记列表（分页、城市筛选、标签筛选、按热度/时间排序）
  - [ ] 查询游记详情（含图片、评论、统计）
  - [ ] 发布游记接口（保存内容 + 图片关联）
  - [ ] 编辑 / 删除我的游记接口
  - [ ] 游记浏览量统计（可异步）

- [ ] **游记互动接口**
  - [ ] 点赞 / 取消点赞接口（记录到行为表）
  - [ ] 收藏 / 取消收藏接口
  - [ ] 评论发布 / 查询接口

- [ ] **景点管理（对外接口）**
  - [ ] 查询城市下的景点列表（分页、标签筛选、按热度排序）
  - [ ] 景点详情查询
  - [ ] 热门景点接口（用于首页）

- [ ] **美食管理（对外接口）**
  - [ ] 查询美食列表与详情
  - [ ] 热门美食接口（用于首页）

---

## 4. 智能旅游线路规划模块

- [ ] **基础数据准备**
  - [ ] 景点表中维护：城市、类型、标签、评分、热度、坐标
  - [ ] 美食表中维护：城市、价位、标签、坐标
  - [ ] 线路模板表与线路明细表（Day1/Day2 等）

- [ ] **线路规划服务（规则层）**
  - [ ] 接收参数：城市、天数、兴趣标签、预算、同行类型等
  - [ ] 根据城市 + 标签筛选景点/美食候选集
  - [ ] 依据热度/评分/标签匹配度评分排序
  - [ ] 按天数分配景点（控制每天数量与类型均衡）
  - [ ] 结合坐标粗略优化行程顺序（距离/区域聚类）

- [ ] **AI 辅助服务**
  - [ ] 封装调用第三方大模型接口
  - [ ] 输入：基础行程结构（JSON）+ 用户偏好摘要
  - [ ] 输出：整体行程概览文案 + 每日行程说明 + 推荐理由
  - [ ] 加入错误兜底（AI 接口失败时返回规则生成的简要说明）

- [ ] **行程结果接口**
  - [ ] 返回完整行程 JSON（行程概要 + 每日安排 + 景点详情引用）
  - [ ] 收藏行程接口（保存到用户行程表）
  - [ ] 查询我的行程列表与详情接口

---

## 5. 打卡与行为记录模块

- [x] **打卡记录接口**
  - [x] 新增打卡接口（景点/美食 ID + 坐标 + 照片地址 + 文本）
  - [x] 我的打卡列表查询
  - [x] 某景点/美食的打卡展示接口

- [x] **行为日志记录**
  - [x] 点赞、收藏、浏览、打卡等行为统一记录到行为表
  - [x] 设计行为类型枚举与权重
  - [x] 提供行为数据给推荐模块使用

---

## 6. 推荐模块

- [x] **用户兴趣模型**
  - [x] 基于用户兴趣标签 + 行为记录，计算用户偏好标签权重
  - [x] 定期（或实时简化）更新用户画像

- [x] **内容推荐接口**
  - [x] 首页推荐旅游线路接口（兴趣 + 热度）
  - [x] 首页推荐游记接口（热度 + 标签匹配）
  - [x] 推荐景点/美食接口（本地热门、与用户偏好匹配）

- [x] **缓存与性能优化**
  - [x] 热门列表使用缓存，定时刷新
  - [x] 用户个性化推荐结构可做短期缓存

---

## 7. 统计与报表模块（后台用）

- [ ] **统计接口**
  - [ ] 用户总数与新增趋势数据接口
  - [ ] 游记发布数量统计接口（按日/周/月）
  - [ ] 打卡次数统计接口
  - [ ] 按城市/景点的访问与互动数据接口

- [ ] **运营视角数据**
  - [ ] 按标签的内容分布统计
  - [ ] 各推荐位点击率统计接口（可选）

---

## 8. 安全与非功能需求

- [ ] 参数校验（JSR-303）
- [ ] 接口权限控制与防重放
- [ ] 文件上传安全（类型/大小限制，存储到对象存储）
- [ ] 日志与审计（关键操作记录，异常日志）
- [ ] 性能优化与压测（分页查询、合理索引）
---

## 9. 接口规范与文档（补充）

- [ ] **接口风格与约定**
  - [ ] 统一使用 `/api/v1/...` 前缀管理版本
  - [ ] 统一分页参数（如 `pageNum`、`pageSize`）与分页响应结构（总数 + 列表）
  - [ ] 统一错误码与消息规范（如 业务错误码表）

- [ ] **接口文档**
  - [ ] 集成 Swagger / Knife4j，自动生成在线接口文档
  - [ ] 要求所有公开接口补充接口注释（说明、入参、出参）
  - [ ] 将接口文档地址写入项目 README / 说明文档

---

## 10. 测试与部署（补充）

- [ ] **测试**
  - [ ] 为核心服务（线路规划服务、推荐服务、AI 封装服务）编写单元测试
  - [ ] 编写基础接口测试用例（登录、规划、游记发布等），整理到 Postman/Apifox 集合
  - [ ] 记录至少一轮手工测试结果（覆盖主要业务流程）

- [ ] **部署与环境**
  - [ ] 编写后端部署说明文档（JAR 启动命令、Nginx 转发配置示例）
  - [ ] 区分 dev/test/prod 配置文件，并说明差异（数据库、Redis、域名等）
  - [ ] 可选：简单 CI 流程设计（代码提交 → 自动构建 + 单元测试）

---

## 11. AI 调用治理（补充）

- [ ] **限流与熔断**
  - [ ] 对 AI 接口调用增加频率限制（单用户、全局）
  - [ ] 当第三方 AI 服务连续失败时，自动短暂熔断，直接走规则兜底方案

- [ ] **调用日志与成本控制**
  - [ ] 记录 AI 调用日志（关键信息：请求摘要、耗时、调用是否成功）
  - [ ] 为 AI 文案长度/调用次数设定上限，避免不必要消耗
  - [ ] 明确只在“正式生成行程”使用 AI，预览/草稿场景可使用规则文案
